<div class="flex justify-between items-start">
  <div>
    <h1 class="font-semibold text-xl"><%= @gig.summary %></h1>
    <p class="italic">
      <% if @gig.start.date.present? %>
        <%= @gig.start.date.strftime("%a %d %b") %>
      <% elsif @gig.start.date_time.present? %>
        <%= @gig.start.date_time.strftime("%a %d %b at %H:%M") %>
      <% end %>
    </p>
    <p class="mb-2"><%= @gig.location %></p>
    <%= render 'user_list', users: @going, status: "going" %>
    <%= render 'user_list', users: @interested, status: "interested" %>
  </div>

  <div class="flex flex-col items-end">
    <%= form_with(model: @response, class: "flex items-center mb-2") do |form| %>
      <%= form.hidden_field :gig_id, value: @gig.id %>
      <%= form.hidden_field :gig_name, value: @gig.summary %>
      <%= form.select :status, ["Not going", "Interested", "Going"], {}, class: "text-sm py-1 rounded" %>
      <%= form.submit @response.id.present? ? "Update" : "Save", class: "border border-2 cursor-pointer rounded px-2 py-1 ml-auto text-sm font-semibold hover:bg-gray-200" %>
    <% end %>
    <% if @gig.creator.email == current_user.email %>
      <%= link_to "Edit gig", edit_gig_path(@gig.id), class: "font-semibold text-blue-700 hover:underline" %>
    <% end %>
  </div>
</div>

<%= render 'clash_list', clashes: @clashes, gig: @gig %>

<%= render 'post_list', posts: @posts %>

<div class="my-4">
  <%= form_with(model: @post, class: "flex flex-col items-end") do |form| %>
    <%= form.hidden_field :gig_id, value: @gig.id %>
    <%= form.hidden_field :gig_name, value: @gig.summary %>
    <%= form.text_area :text, class: "w-full", required: true %>

    <%= submit_tag "Add post", class: "border border-2 cursor-pointer rounded px-2 mt-2 ml-auto font-semibold hover:bg-gray-200" %>
  <% end %>
</div>
